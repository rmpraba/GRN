
<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../../bower_components/paper-menu/paper-menu.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/iron-input/iron-input.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<link rel="import" href="../physicqualified-service/physicqualified-service.html">
<link rel="import" href="../grn-service/grn-service.html">
<meta name="viewport" content="width=device-width, initial-scale=1">
<dom-module id="grnflow-card">
  <template>
    <style is="custom-style">
      .card{
        @apply(--layout-horizontal);
      }
      div.main {
        margin-right5%;
        margin-left:0px;
      }
      ol > li {
        display: table-cell;
        height: 34px;
        position: relative;
        padding: 0px;
        margin: 0px;
        text-align: center;
      //padding-left: 10px;
        border: 1px solid #f2f2f2;
      }
      ol > li > div {
        position:relative;
        line-height: 30px; /* equal to the list item's height */
        height:101%;
        width: 100%;
        background-color: #f2f2f2;
      }
      ol>li:hover {
        background-color: #d68a3a;
        cursor: pointer;
        color: white;
      }
      ol {
        display: table;
        width: 60%;
        padding: 0px;
        margin: 0px;
        position: relative;
      }
      ol > li > div:after, ol > li > div:before {
        content:"";
        display:inline-block;
        border-width: 16px;
        border-style: solid;
        width: 0px;
        height: 0px;
        left: 100%;
        top: -1px;
        position: absolute;
        z-index: 1;
        border-color: transparent transparent transparent #c0dbb7;
      }
      ol > li > div:before {
        border-width: 14px;
        display: block;
        border-color: transparent transparent transparent  #f2f2f2;
        z-index: 2;
        top:1px;
      }
      ol > li > #Stores:after, ol > li > #Stores:before {
        content:"";
        display:inline-block;
        border-width: 16px;
        border-style: solid;
        width: 0px;
        height: 0px;
        left: 100%;
        top: -1px;
        position: absolute;
        z-index: 1;
        border-color: transparent transparent transparent #bfbfbf;
      }
      ol > li > #Production:after, ol > li > #Production:before {
        content:"";
        display:inline-block;
        border-width: 16px;
        border-style: solid;
        width: 0px;
        height: 0px;
        left: 100%;
        top: -1px;
        position: absolute;
        z-index: 1;
        border-color: transparent transparent transparent #bfbfbf;
      }
      ol > li > #Quality:after, ol > li > #Quality:before {
        content:"";
        display:inline-block;
        border-width: 16px;
        border-style: solid;
        width: 0px;
        height: 0px;
        left: 100%;
        top: -1px;
        position: absolute;
        z-index: 1;
        border-color: transparent transparent transparent #bfbfbf;
      }
      ol > li > #Purchase:after, ol > li > #Purchase:before {
        content:"";
        display:inline-block;
        border-width: 16px;
        border-style: solid;
        width: 0px;
        height: 0px;
        left: 100%;
        top: -1px;
        position: absolute;
        z-index: 1;
        border-color: transparent transparent transparent #bfbfbf;
      }
      ol > li > #Confirm:after, ol > li > #Confirm:before {
        content:"";
        display:inline-block;
        border-width: 16px;
        border-style: solid;
        width: 0px;
        height: 0px;
        left: 100%;
        top: -1px;
        position: absolute;
        z-index: 1;
        border-color: transparent transparent transparent #bfbfbf;
      }
      .flowbutton{
        margin-left: 20%;
      }
    </style>

    <div class="main">
      <ol>
        <li>
          <div id="Stores1"><paper-button noink id="Stores" style="height:9px;width:10px;text-transform:none;margin-top:-10px;" on-click="click">Stores</paper-button></div>
        </li>
        <li>
          <div id="Production1"><paper-button noink id="Production" style="height:9px;width:10px;text-transform:none;margin-top:-10px;" on-click="click">Production</paper-button></div>
        </li>
        <li>
          <div id="Quality1"><paper-button noink id="Quality" style="height:9px;width:10px;text-transform:none;margin-top:-10px;" on-click="click">Quality</paper-button></div>
        </li>
        <li>
          <div id="Purchase1"><paper-button noink id="Purchase" style="height:9px;width:10px;text-transform:none;margin-top:-10px;" on-click="click">Purchase</paper-button></div>
        </li>
        <li>
          <div id="Confirm1"><paper-button  noink id="Confirm" style="height:9px;width:10px;text-transform:none;margin-top:-10px;" on-click="click">Confirm</paper-button></div>
        </li>
      </ol>
    </div>

    <grn-service ></grn-service>
  </template>
  <script>
    Polymer({
      is: "grnflow-card",
      ready:function()
      {
        this.searchstateflag="true";
        //this.enabled=true;
        this.idval=["Stores","Production","Quality","Purchase","Confirm"];
        this.flag="true";
        this.flowenableflag="";
        var role=[{"rolename":"Stores manager","index":"0"},
          {"rolename":"Production manager","index":"1"},
          {"rolename":"Quality manager","index":"2"},
          {"rolename":"Purchase manager","index":"3"},
          {"rolename":"manager","index":"4"}];

        for(var i=0;i<role.length;i++)
        {
          if(role[i].rolename==sessionStorage.getItem("loggedrole"))
          {
            this.flowenableflag=role[i].index;
          }
        }

        // alert(this.flowenableflag);
        var buttongroup=this.querySelectorAll('paper-button');

        //Logged as general role for search disable all state
        if(this.flowenableflag==4)
        {
          // alert("true");
          for(var i=0;i<buttongroup.length;i++)
          {
            //alert("in"+  this.querySelector("#"+buttongroup[i].id));
            this.querySelector("#"+buttongroup[i].id).disabled=true;
            //this.querySelector("#"+buttongroup[i].id).style.backgroundColor="#e5efe2";
            this.querySelector("#"+buttongroup[i].id).style.backgroundColor="transparent";
          }
        }
        //Logged as other flow managers
        else{
          for(var i=0;i<buttongroup.length;i++)
          {
            if(i<=this.flowenableflag)
              this.querySelector("#"+buttongroup[i].id).disabled=false;

            else{
              this.querySelector("#"+buttongroup[i].id).disabled=true;
              this.querySelector("#"+buttongroup[i].id).style.backgroundColor="transparent";
            }
          }
        }



        /*alert(this.flowenableflag);
         var buttongroup=this.querySelectorAll('paper-button');
         for(var i=0;i<buttongroup.length;i++)
         {
         if(i<=this.flowenableflag)
         this.querySelector("#"+buttongroup[i].id).disabled=false;

         else{
         this.querySelector("#"+buttongroup[i].id).disabled=true;
         this.querySelector("#"+buttongroup[i].id).style.backgroundColor="transparent";
         }
         }*/

        if(sessionStorage.getItem("loggedrole")=="Stores manager"){
          this.querySelector("#"+this.idval[0]+"1").id=this.idval[0];
          this.querySelector("#"+this.idval[0]).style.backgroundColor='#bfbfbf';
          //this.querySelector("#"+this.idval[0]).style.color='white';
          this.flag=this.idval[0];
        }
        else if(sessionStorage.getItem("loggedrole")=="Production manager"){
          this.querySelector("#"+this.idval[1]+"1").id=this.idval[1];
          this.querySelector("#"+this.idval[1]).style.backgroundColor='#bfbfbf';
          this.flag=this.idval[1];
        }
        else if(sessionStorage.getItem("loggedrole")=="Quality manager"){
          this.querySelector("#"+this.idval[2]+"1").id=this.idval[2];
          this.querySelector("#"+this.idval[2]).style.backgroundColor='#bfbfbf';
          this.flag=this.idval[2];
        }
        else if(sessionStorage.getItem("loggedrole")=="Purchase manager"){
          this.querySelector("#"+this.idval[3]+"1").id=this.idval[3];
          this.querySelector("#"+this.idval[3]).style.backgroundColor='#bfbfbf';
          this.flag=this.idval[3];
        }
      },
      click:function(e)
      {
        //alert(this.flag+"  "+e.target.id);
        if(this.flag=="true")
        {
          this.querySelector("#"+e.target.id+"1").id=e.target.id;
          this.querySelector("#"+e.target.id).style.backgroundColor='#bfbfbf';
          this.flag=e.target.id;
        }
        else{
          this.querySelector("#"+this.flag).style.backgroundColor='#f2f2f2';
          this.querySelector("#"+this.flag).id=this.flag+"1";
          this.querySelector("#"+e.target.id+"1").id=e.target.id;
          this.querySelector("#"+e.target.id).style.backgroundColor='#bfbfbf';
          this.flag=e.target.id;
        }
        document.querySelector('home-page').setPage('Inward Flow');
        localStorage.setItem("curr_sess_forwardstate",'0');
        if(sessionStorage.getItem("loggedrole")=="Stores manager"){
          var flowflag=localStorage.getItem('curr_sess_flowstate');
          if(e.target.id=='Stores'&&flowflag=="1"||e.target.id=='Stores'&&flowflag=="0"){
            window.location.href="indexhome.html";
          }
        }
        if(sessionStorage.getItem("loggedrole")=="Production manager"){
          var flowflag=localStorage.getItem('curr_sess_flowstate');
          if(e.target.id=='Stores'&&flowflag=="0"){
            document.querySelector('my-app').setVisible("false");
            localStorage.setItem("curr_sess_expandstate",'OldNew');
            document.querySelector('physicinsread-page').setState('OldNew');
          }
          if(e.target.id=='Production'&&flowflag=="0"){
            document.querySelector('my-app').setVisible("true");
            document.querySelector('home-page').setPage('Inward Items');
          }
          if(e.target.id=='Production'&&flowflag=="1"){
            window.location.href="indexhome.html";
          }
        }

        if(sessionStorage.getItem("loggedrole")=="Quality manager"){
          var flowflag=localStorage.getItem('curr_sess_flowstate');
          if(e.target.id=='Stores'&&flowflag=="0"){
            document.querySelector('my-app').setVisible("false");
            localStorage.setItem("curr_sess_expandstate",'OldNew');
            document.querySelector('physicinsread-page').setState('OldNew');
          }
          if(e.target.id=='Production'&&flowflag=="0"){
            document.querySelector('my-app').setVisible("false");
            localStorage.setItem("curr_sess_expandstate",'OldDraft');
            document.querySelector('physicinsread-page').setState('OldDraft');
          }
          if(e.target.id=='Quality'&&flowflag=="0"){
            document.querySelector('my-app').setVisible("true");
            document.querySelector('home-page').setPage('Inward Items');
            //localStorage.setItem("curr_sess_expandstate",'physicqualified');
            //localStorage.setItem("curr_sess_forwardstate",'1');
            //document.querySelector('physicinsread-page').setState('physicqualified');
          }
          if(e.target.id=='Quality'&&flowflag=="1"){
            window.location.href="indexhome.html";
            //document.querySelector('physicinsitem-card').setToggleFlag();
            //document.querySelector('home-page').setPage('Inward Items');
            //document.querySelector('grn-service').physicreadService();
          }
        }


        if(sessionStorage.getItem("loggedrole")=="Purchase manager"){
          var flowflag=localStorage.getItem('curr_sess_flowstate');
          if(e.target.id=='Stores'&&flowflag=="0"){
            document.querySelector('my-app').setVisible("false");
            localStorage.setItem("curr_sess_expandstate",'OldNew');
            document.querySelector('physicinsread-page').setState('OldNew');
          }
          if(e.target.id=='Production'&&flowflag=="0"){
            document.querySelector('my-app').setVisible("false");
            localStorage.setItem("curr_sess_expandstate",'OldDraft');
            document.querySelector('physicinsread-page').setState('OldDraft');
          }
          if(e.target.id=='Quality'&&flowflag=="0"){
            document.querySelector('my-app').setVisible("false");
            localStorage.setItem("curr_sess_expandstate",'Oldphysicqualified');
            document.querySelector('physicinsread-page').setState('Oldphysicqualified');
          }
          if(e.target.id=='Purchase'&&flowflag=="0"){
            document.querySelector('my-app').setVisible("true");
            document.querySelector('home-page').setPage('Inward Items');
            //localStorage.setItem("curr_sess_expandstate",'qualified');
            //localStorage.setItem("curr_sess_forwardstate",'1');
            //document.querySelector('physicinsread-page').setState('qualified');
          }
          if(e.target.id=='Purchase'&&flowflag=="1"){
            window.location.href="indexhome.html";
            //document.querySelector('home-page').setPage('Inward Items');
            //document.querySelector('grn-service').physicreadService();
          }
        }

      },
      setFlag:function(){
        if(sessionStorage.getItem("loggedrole")=="Stores manager"){
          this.querySelector("#"+this.flag).style.backgroundColor='#f2f2f2';
          this.querySelector("#"+this.flag).id=this.flag+"1";
          this.querySelector("#"+this.idval[1]+"1").id=this.idval[1];
          this.querySelector("#"+this.idval[1]).style.backgroundColor='#bfbfbf';
          this.flag=this.idval[1];
        }
        else if(sessionStorage.getItem("loggedrole")=="Production manager"){
          this.querySelector("#"+this.flag).style.backgroundColor='#f2f2f2';
          this.querySelector("#"+this.flag).id=this.flag+"1";
          this.querySelector("#"+this.idval[2]+"1").id=this.idval[2];
          this.querySelector("#"+this.idval[2]).style.backgroundColor='#bfbfbf';
          this.flag=this.idval[2];
        }
        else if(sessionStorage.getItem("loggedrole")=="Quality manager"){
          this.querySelector("#"+this.flag).style.backgroundColor='#f2f2f2';
          this.querySelector("#"+this.flag).id=this.flag+"1";
          this.querySelector("#"+this.idval[3]+"1").id=this.idval[3];
          this.querySelector("#"+this.idval[3]).style.backgroundColor='#bfbfbf';
          this.flag=this.idval[3];
        }
        else if(sessionStorage.getItem("loggedrole")=="Purchase manager"){
          this.querySelector("#"+this.flag).style.backgroundColor='#f2f2f2';
          this.querySelector("#"+this.flag).id=this.flag+"1";
          this.querySelector("#"+this.idval[4]+"1").id=this.idval[4];
          this.querySelector("#"+this.idval[4]).style.backgroundColor='#bfbfbf';
          this.flag=this.idval[4];
        }
      },
      disableBackstate:function(){
        var flowflag=localStorage.getItem('curr_sess_flowstate');

        /*var alldiv=this.querySelectorAll('.div');
         for(var i=0;i<alldiv.length;i++)
         alert(this.querySelector("#"+alldiv[i].id));*/

        if(flowflag=="1"){
          // alert(this.flowenableflag);
          var buttongroup=this.querySelectorAll('paper-button');
          for(var i=0;i<buttongroup.length;i++)
          {
            if(i==(parseInt(this.flowenableflag))||i==(parseInt(this.flowenableflag)+1))
            {
              this.querySelector("#"+buttongroup[i].id).disabled=false;
              if(i==(parseInt(this.flowenableflag)+1)){
                this.querySelector("#"+buttongroup[i].id).disabled=false;
                this.querySelector("#"+buttongroup[i].id).style.backgroundColor="transparent";
              }
              //this.querySelector("#Purchase").innerHTML = "hello";
            }

            else{
              this.querySelector("#"+buttongroup[i].id).disabled=true;
              this.querySelector("#"+buttongroup[i].id).style.backgroundColor="transparent";
            }
          }
        }
      },
      setSearchflowState:function(state,stateno){

        if(this.searchstateflag=="true"){
          this.querySelector("#"+(this.idval[stateno-1])+"1").id=this.idval[stateno-1];
          this.querySelector("#"+(this.idval[stateno-1])).style.backgroundColor="#bfbfbf";
          this.searchstateflag=this.idval[stateno-1];
        }
        else{
          this.querySelector("#"+this.searchstateflag).style.backgroundColor='#f2f2f2';
          this.querySelector("#"+this.searchstateflag).id=this.searchstateflag+"1";
          this.querySelector("#"+(this.idval[stateno-1])+"1").id=this.idval[stateno-1];
          this.querySelector("#"+(this.idval[stateno-1])).style.backgroundColor='#bfbfbf';
          this.searchstateflag=this.idval[stateno-1];
        }
      }
    });
  </script>
</dom-module>
