<link rel="import" href="../../bower_components/iron-form/iron-form.html">
<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../../bower_components/paper-menu/paper-menu.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/iron-input/iron-input.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../../bower_components/paper-tab/paper-tab.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../physicqualify-service/physicqualify-service.html">
<meta name="viewport" content="width=device-width, initial-scale=1">
<dom-module id="physicqualifyitem-card">
  <template>
    <style>
      .repeatcard{
        @apply(--layout-horizontal);
        width: 110%;
        margin-top: -1%;
      // height:50%;
        text-align: center;
      }
      paper-item{
        width: 25%;
        margin-left: 5%;
      //text-align: center;
      }
      paper-input{
        margin-top:-2%;
        width: 20%;
        margin-left: -10%;
      }
      paper-icon-button{
        width: 15%;
        margin-top: 2%;
      }
      textarea{
        height:5%;
        margin-top:2%;
        margin-left:5%;
      }
    </style>

    <form is="iron-form" id="form" method='POST' action="{{url}}" on-iron-form-response="Response">
      <div class="repeatcard">
        <paper-input name="status" value="{{status}}" hidden></paper-input>
        <paper-input name="newstatus" value="{{newstatus}}" hidden></paper-input>
        <paper-input name="inwardno" value="{{inwardno}}" hidden></paper-input>
        <paper-input name="ponumber" value="{{ponumber}}" hidden></paper-input>
        <paper-input name="podate" value="{{podate}}" hidden></paper-input>
        <paper-input name="suppliername" value="{{suppliername}}" hidden></paper-input>
        <paper-input name="itemdes" value="{{itemdes}}" hidden></paper-input>
        <paper-item name="itemdes" value="{{itemdes}}">{{itemdes}}</paper-item>
        <!--<paper-input name="qtyordered" value="{{qtyordered}}" readonly="{{enable}}" hidden></paper-input>-->
        <paper-item name="qtyreceived" value="{{qtyreceived}}">{{qtyreceived}}</paper-item>
        <paper-input name="qtyaccepted" value="{{qtyaccepted}}" required id="{{inwardno}}" error-message="{{msg}}"></paper-input>
        <textarea name="remark" value="{{remarks::input}}">{{remarks}}</textarea>
        <paper-icon-button icon="icons:save" on-click="save" style="width:5%;"></paper-icon-button>
      </div>
    </form>
  </template>
  <script>
    Polymer({is:"physicqualifyitem-card",
      ready:function(){

        this.url=sessionStorage.getItem("curr_sess_url")+"physicqualifyitem-card";

      },
      save:function(){
        //alert(this.ponumber)
        this.msg="Enter no's only";
        if(this.qtyaccepted>this.qtyreceived){
          this.msg="Error";
          this.querySelector('#'+this.inwardno).validate();
          this.qtyaccepted="";
          alert("Accepted quantity greater than received quantity!");
        }
        else{
          if((this.ponumber==null||this.ponumber=="")&&(localStorage.getItem("curr_sess_POchangeflag")!=1))
          {
            alert("PO number should be filled out!");
          }
          else
          {
            this.podate=localStorage.getItem("localsess_curr_inwarddate");
            this.ponumber=localStorage.getItem("curr_sess_PONumber");
            if(sessionStorage.getItem("loggedrole")=="Stores manager"){
              this.status="New";
              this.newstatus="OldNew";
            }
            if(sessionStorage.getItem("loggedrole")=="Production manager"){
              this.status="Draft";
              this.newstatus="OldDraft";
            }
            else if(sessionStorage.getItem("loggedrole")=="Quality manager"){
              this.status="physicqualified";
              this.newstatus="Oldphysicqualified";
            }
            else if(sessionStorage.getItem("loggedrole")=="Purchase manager"){
              this.status="qualified";
              this.newstatus="Oldqualified";
            }
            this.$.form.submit();
          }

        }
      },
      Response:function(e)
      {
        alert(e.detail.response.flag);
      }
    });
  </script>

</dom-module>
